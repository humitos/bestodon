	<div id="pagination" class="flex flex-wrap justify-center gap-4 my-4"></div>
	<div class="w-full pl-14 pr-2 max-w-5xl mt-2 m-4 p-2 max-w-5xl mx-auto text-neutral-500 flex-wrap gap-8 md:flex md:mx-auto md:p-0">
		<div>
			<p class="text-white font-bold mb-2">
				Bestodon
			</p>
			<p>
				Under the GNU/GPLv3 or newer license.
			</p>
		</div>
		<div>
			<p class="text-white font-bold my-2 md:mt-0">
				Powered by
			</p>
			<p>
				{% include icons/gh-pages.svg %}
			</p>
		</div>
		<div>
			<p class="text-white font-bold my-2 md:mt-0">
				Make with
			</p>
			<div class="grid grid-cols-2 gap-2 w-full md:mx-auto md:grid-cols-3 md:px-0">
				<a href="https://jekyllrb.com" target="_blank" class="hover:text-white">
					Jekyll
				</a>
				<a href="https://tailwindcss.com/" target="_blank" class="hover:text-white">
					Tailwind CSS
				</a>
				<a href="https://axios-http.com/" target="_blank" class="hover:text-white">
					Axios
				</a>
				<a href="https://son-link.github.io/pequejs/" target="_blank" class="hover:text-white">
					PequeJS
				</a>
				<a href="https://heroicons.com/" target="_blank" class="hover:text-white">
					Heroicons
				</a>
				<a href="https://simpleicons.org/" target="_blank" class="hover:text-white">
					Simple Icons
				</a>
			</div>
		</div>
		<div>
			<p class="text-white font-bold my-2 md:mt-0">
				Links
			</p>
			<p>
				<ul>
					<li>
						<a href="https://github.com/son-link/bestodon" target="_blank" class="hover:text-white">
							Source code
						</a>
					</li>
					<li>
						<a href="https://joinmastodon.org/" target="_blank" class="hover:text-white">
							Join Mastodon
						</a>
					</li>
				</ul>
			</p>
		</div>
	</div>
	<script type="text/html" id="account-tpl">
		<% items.forEach( (item) => { %>
			<% 
				let remote_follow = `https://${item.domain}/users/${item.username}/remote_follow`;
				if (item.domain == 'mastodon.social') remote_follow = item.url;
			%> 
			<div class="rounded-lg w-full bg-neutral-800 text-white p-2 relative">
				<a href="<%= item.url %>" target="_blank">
					<div>
						<img src="<%= item.header %>" class="object-cover h-32 w-full rounded bg-neutral-900" />
					</div>
					<div class="px-2 flex flex-wrap gap-2">
						<div class="-translate-y-2">
							<img src="<%= item.avatar %>" class="rounded-lg w-16 h-16 bg-neutral-900" />
						</div>
						<div class="mt-2">
							<p><%= item.display_name %></p>
							<p class="text-neutral-500">
								@<%= item.username %>@<%= item.domain %>
							</p>
						</div>
					</div>
				</a>
				<div class="p-2 h-20 overflow-hidden mb-4">
					<%- item.note %>
				</div>
				<a
					class="rounded bg-blue-600 text-white w-24 h-9 flex flex-wrap items-center justify-center gap-2 mastodon-btn hover:bg-blue-500"
					href="<%= remote_follow %>"
					target="_blank"
				>
					<svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="fill-current h-6 w-6">
						<path d="M23.268 5.313c-.35-2.578-2.617-4.61-5.304-5.004C17.51.242 15.792 0 11.813 0h-.03c-3.98 0-4.835.242-5.288.309C3.882.692 1.496 2.518.917 5.127.64 6.412.61 7.837.661 9.143c.074 1.874.088 3.745.26 5.611.118 1.24.325 2.47.62 3.68.55 2.237 2.777 4.098 4.96 4.857 2.336.792 4.849.923 7.256.38.265-.061.527-.132.786-.213.585-.184 1.27-.39 1.774-.753a.057.057 0 0 0 .023-.043v-1.809a.052.052 0 0 0-.02-.041.053.053 0 0 0-.046-.01 20.282 20.282 0 0 1-4.709.545c-2.73 0-3.463-1.284-3.674-1.818a5.593 5.593 0 0 1-.319-1.433.053.053 0 0 1 .066-.054c1.517.363 3.072.546 4.632.546.376 0 .75 0 1.125-.01 1.57-.044 3.224-.124 4.768-.422.038-.008.077-.015.11-.024 2.435-.464 4.753-1.92 4.989-5.604.008-.145.03-1.52.03-1.67.002-.512.167-3.63-.024-5.545zm-3.748 9.195h-2.561V8.29c0-1.309-.55-1.976-1.67-1.976-1.23 0-1.846.79-1.846 2.35v3.403h-2.546V8.663c0-1.56-.617-2.35-1.848-2.35-1.112 0-1.668.668-1.67 1.977v6.218H4.822V8.102c0-1.31.337-2.35 1.011-3.12.696-.77 1.608-1.164 2.74-1.164 1.311 0 2.302.5 2.962 1.498l.638 1.06.638-1.06c.66-.999 1.65-1.498 2.96-1.498 1.13 0 2.043.395 2.74 1.164.675.77 1.012 1.81 1.012 3.12z"/>
					</svg>
					Follow
				</a>
			</div>
		<% }); %> 
	</script>
	<script type="text/javascript">
		let accounts = [];
      	let page = 1;
		axios.defaults.baseURL = '{{ site.url }}';

		if (location.hash) page = parseInt(location.hash.replace('#page-', ''));

		const paginate = (items, page = 1, perPage = 10) => {
			const offset = perPage * (page - 1);
			const totalPages = Math.ceil(items.length / perPage);
			const paginatedItems = items.slice(offset, perPage * page);
			
			return {
				previousPage: page - 1 ? page - 1 : null,
				nextPage: (totalPages > page) ? page + 1 : null,
				total: items.length,
				totalPages: totalPages,
				items: paginatedItems
			};
		};
	  
		const getData = list => {
			axios.get(`/assets/lists/${list}.json`)
			.then( resp => {
				accounts = resp.data;
				if (page > 1) drawAccounts();
				drawPagination();
			});
		}
		  
		const drawAccounts = () => {
			data = paginate(accounts, page, 10);
			const tpl = $('#account-tpl').html();
			const html = ejs.render(tpl, { items: data.items });
			$(list).html(html)
		}
	
		const drawPagination = () => {
			$('#pagination').empty();
			const totalPages = Math.ceil(accounts.length / 10);

			if (page > 1) {
				$('#pagination').append(`<a class="md:w-8 h-8 text-white flex items-center justify-center" href="#page-${page-1}">
					{% include icons/prev.svg %}
					<span class="md:hidden">Prev</span>
				</a>`);
			}

			for (i = 0; i < totalPages; i++) {
				if (page == i+1)
					$('#pagination').append(`<span class="rounded-full bg-gray-100 w-8 h-8 items-center justify-center hidden md:flex">${i+1}</span>`);
				else
					$('#pagination').append(`<a class="rounded-full text-white w-8 h-8 items-center justify-center hidden md:flex" href="#page-${i+1}">${i+1}</a>`);
			}

			if (page < totalPages) {
				$('#pagination').append(`<a class="text-white md:w-8 h-8 flex items-center justify-center" href="#page-${page+1}">
					<span class="md:hidden">Next</span>
					{% include icons/next.svg %}
				</a>`);
			}
		}

		document.addEventListener("DOMContentLoaded", () => {
			$('#pagination').on('click', 'a', function(e) {
				if (! $(this).attr('href').startsWith('#page-')) return;

				page = parseInt($(this).attr('href').replace('#page-', ''));
				drawPagination();
				drawAccounts();
				window.scrollTo({ top: 0, behavior: 'smooth' })
			});
		});
	</script>
	</body>
</html>